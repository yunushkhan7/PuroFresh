<app-spinner *ngIf="spinner == true"></app-spinner>

<!-- Container-fluid starts-->
<div class="container-fluid">
    <div class="card" *ngIf="showlist == true">
        <div class="card-header">
            <div class="row">
                <div class="col-sm-6">
                    <h5 style="float:left">Filter</h5>
                </div>
                <div class="col-sm-2">
                    <select class="status form-control" #status (change)="SelectStatus(status.value)">
                        <option value="" selected>Select status</option>
                        <option *ngFor="let status of orderstatus" value="{{status.statusCode}}">
                            {{status.internalStatus}}</option>
                    </select>
                </div>
                <div class="col-sm-2">
                    <select class="status form-control" #slot (change)="Selectslot(slot.value)">
                        <option value="" selected>Select slot</option>
                        <option *ngFor="let slot of allsots" value="{{slot.slotId}}">{{slot.slotStartTime}} -
                            {{slot.slotEndTime}}</option>
                    </select>
                </div>
                <div class="col-sm-2" *ngIf="showlist == true">
                    <button type="button"
                        class="btn btn-primary waves-effect waves-light f-right d-inline-block md-trigger"
                        (click)="hidelistfunction()">back</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12">
            <div class="card">
                <div class="card-header">
                    <div class="row">

                        <div class="col-sm-6">
                            <h5>{{title}}</h5>

                        </div>

                        <div class="col-sm-3">


                        </div>


                    </div>
                    <div class="card-body" *ngIf="showlist == false">
                        <div class="row">
                            <div class="col-xl-4 col-md-6 xl-33">
                                <a href="javascript:;" class="m-r-15 crm-action-edit text-muted text-primary"
                                    (click)="showlistfunction(1)">
                                    <div class="card o-hidden widget-cards">
                                        <div class="bg-warning card-body">
                                            <div class="media static-top-widget row">
                                                <div class="icons-widgets col-4">
                                                    <div class="align-self-center text-center">
                                                        <app-feather-icons [icon]="'navigation'"
                                                            class="font-warning"></app-feather-icons>
                                                    </div>
                                                </div>
                                                <div class="media-body col-8"><span class="m-0">Today's Orders</span>
                                                    <h3 class="mb-0"><span class="counter">{{orderno}} </span><small>
                                                            Orders</small></h3>
                                                </div>


                                            </div>
                                        </div>
                                    </div>
                                </a>
                            </div>


                            <div class="col-xl-4 col-md-6 xl-33">
                                <a href="javascript:;" class="m-r-15 crm-action-edit text-muted text-primary"
                                    (click)="showlistfunction(2)">
                                    <div class="card o-hidden widget-cards">
                                        <div class="bg-danger card-body">
                                            <div class="media static-top-widget row">
                                                <div class="icons-widgets col-4">
                                                    <div class="align-self-center text-center">
                                                        <app-feather-icons [icon]="'x-octagon'"
                                                            class="font-danger"></app-feather-icons>
                                                    </div>
                                                </div>
                                                <div class="media-body col-8"><span class="m-0">Confirmed</span>
                                                    <h3 class="mb-0"> <span
                                                            class="counter">{{Confirmedno}}</span><small> Orders</small>
                                                    </h3>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                            </div>


                            <div class="col-xl-4 col-md-6 xl-33">
                                <a href="javascript:;" class="m-r-15 crm-action-edit text-muted text-primary"
                                    (click)="showlistfunction(3)">
                                    <div class="card o-hidden widget-cards">
                                        <div class="bg-primary card-body">
                                            <div class="media static-top-widget row">
                                                <div class="icons-widgets col-4">
                                                    <div class="align-self-center text-center">
                                                        <app-feather-icons [icon]="'activity'"
                                                            class="font-primary"></app-feather-icons>
                                                    </div>
                                                </div>
                                                <div class="media-body col-8"><span class="m-0">In progress</span>
                                                    <h3 class="mb-0"> <span class="counter">{{Progressno}}</span><small>
                                                            Orders</small></h3>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                            </div>

                            <div class="col-xl-4 col-md-6 xl-33">
                                <a href="javascript:;" class="m-r-15 crm-action-edit text-muted text-primary"
                                    (click)="showlistfunction(4)">
                                    <div class="card o-hidden  widget-cards">
                                        <div class="bg-secondary card-body">
                                            <div class="media static-top-widget row">
                                                <div class="icons-widgets col-4">
                                                    <div class="align-self-center text-center">
                                                        <app-feather-icons [icon]="'truck'"
                                                            class="font-secondary"></app-feather-icons>
                                                    </div>
                                                </div>
                                                <div class="media-body col-8"><span class="m-0">Ready for
                                                        Manifest</span>
                                                    <h3 class="mb-0"><span class="counter">{{Intransitno}}</span><small>
                                                            Orders</small></h3>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                            </div>

                            <div class="col-xl-4 col-md-6 xl-33">
                                <a href="javascript:;" class="m-r-15 crm-action-edit text-muted text-primary"
                                    (click)="showlistfunction(5)">
                                    <div class="card o-hidden widget-cards">
                                        <div class="bg-primary card-body">
                                            <div class="media static-top-widget row">
                                                <div class="icons-widgets col-4">
                                                    <div class="align-self-center text-center">
                                                        <app-feather-icons [icon]="'x-octagon'"
                                                            class="font-primary"></app-feather-icons>
                                                    </div>
                                                </div>
                                                <div class="media-body col-8"><span class="m-0">Job Assigned</span>
                                                    <h3 class="mb-0"> <span class="counter">{{Manifestno}}</span><small>
                                                            Orders</small></h3>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                            </div>

                            <div class="col-xl-4 col-md-6 xl-33">
                                <a href="javascript:;" class="m-r-15 crm-action-edit text-muted text-primary"
                                    (click)="showlistfunction(6)">
                                    <div class="card o-hidden widget-cards">
                                        <div class="bg-warning card-body">
                                            <div class="media static-top-widget row">
                                                <div class="icons-widgets col-4">
                                                    <div class="align-self-center text-center">
                                                        <app-feather-icons [icon]="'x-octagon'"
                                                            class="font-warning"></app-feather-icons>
                                                    </div>
                                                </div>
                                                <div class="media-body col-8"><span class="m-0">Delivered</span>
                                                    <h3 class="mb-0"> <span
                                                            class="counter">{{Deliveredno}}</span><small> Orders</small>
                                                    </h3>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                            </div>

                            <div class="col-xl-4 col-md-6 xl-33">
                                <a href="javascript:;" class="m-r-15 crm-action-edit text-muted text-primary"
                                    (click)="showlistfunction(7)">
                                    <div class="card o-hidden widget-cards">
                                        <div class="bg-primary card-body">
                                            <div class="media static-top-widget row">
                                                <div class="icons-widgets col-4">
                                                    <div class="align-self-center text-center">
                                                        <app-feather-icons [icon]="'x-octagon'"
                                                            class="font-primary"></app-feather-icons>
                                                    </div>
                                                </div>
                                                <div class="media-body col-8"><span class="m-0">Cancelled</span>
                                                    <h3 class="mb-0"> <span
                                                            class="counter">{{Cancelledno}}</span><small> Orders</small>
                                                    </h3>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                            </div>

                        </div>
                    </div>

                    <div class="card-body" *ngIf="showlist == true">
                        <div id="batchDelete" class="category-table custom-datatable transcation-datatable user-image">
                            <div class="project-table">
                                <div id="crm-contact" class="dt-responsive">
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-12 col-sm-12 col-md-6">
                                            <div>
                                                <label class="label-control">Show
                                                    <select class="form-control input-sm full-data-show-entry"
                                                        [(ngModel)]="rowsOnPage">
                                                        <option [ngValue]="5">5</option>
                                                        <option [ngValue]="10">10</option>
                                                        <option [ngValue]="25">25</option>
                                                        <option [ngValue]="50">50</option>
                                                        <option [ngValue]="100">100</option>
                                                    </select>
                                                    entries
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-xs-12 col-sm-12 col-md-6">
                                            <div style="text-align: right;">
                                                <label>Search:
                                                    <input type="search" [(ngModel)]="filterQuery"
                                                        class="form-control input-sm full-data-search"
                                                        placeholder="Search name">
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- <div class="panel-heading">User information</div>-->
                                    <div>
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered full-data-table"
                                                [mfData]="order | dataFilter: {subOrderId: filterQuery, firstName: filterQuery, lastName:filterQuery,createdDateTime: filterQuery, slotDate: filterQuery, slotTime: filterQuery, orderStatus: filterQuery, orderAmount: filterQuery}"
                                                #mf="mfDataTable" [mfRowsOnPage]="rowsOnPage" [(mfSortBy)]="sortBy"
                                                [(mfSortOrder)]="sortOrder">
                                                <thead>
                                                    <tr>
                                                        <th>
                                                            <mfDefaultSorter by="subOrderId">Suborder id
                                                            </mfDefaultSorter>
                                                        </th>
                                                        <th>
                                                            <mfDefaultSorter by="firstName">Customer name
                                                            </mfDefaultSorter>
                                                        </th>
                                                        <th>
                                                            <mfDefaultSorter by="registeredMobile">Phone No.
                                                            </mfDefaultSorter>
                                                        </th>
                                                        <th>
                                                            <mfDefaultSorter by="createdDateTime">Order date
                                                            </mfDefaultSorter>
                                                        </th>
                                                        <th>
                                                            <mfDefaultSorter by="slotDate">Delivery date
                                                            </mfDefaultSorter>
                                                        </th>
                                                        <!-- <th>
                                <mfDefaultSorter by="paymentType">Payment type</mfDefaultSorter>
                              </th> -->
                                                        <th>
                                                            <mfDefaultSorter by="slotTime">Slot time</mfDefaultSorter>
                                                        </th>
                                                        <th>
                                                            <mfDefaultSorter by="orderStatus">Status</mfDefaultSorter>
                                                        </th>
                                                        <!-- <th>
                                <mfDefaultSorter by="orderAmount">Total amount</mfDefaultSorter>
                              </th> -->
                                                        <th>
                                                            <mfDefaultSorter>Action</mfDefaultSorter>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let order of mf.data">
                                                        <td>{{order.subOrderId}}</td>
                                                        <td>{{order.firstName}} {{order.lastName}}</td>
                                                        <td>{{order.customeraddress.registeredMobile}}</td>
                                                        <td>{{order.createdDateTime}}</td>
                                                        <td>{{order.slotDate}}</td>
                                                        <!-- <td>{{order.paymentType}}</td> -->
                                                        <td>{{order.slotTime}}</td>
                                                        <td *ngIf="order.statusCode == 'CN'"><span
                                                                class="badge badge-primary">{{order.orderStatus}}</span>
                                                        </td>
                                                        <td *ngIf="order.statusCode == 'FF'"><span
                                                                class="badge badge-warning">{{order.orderStatus}}</span>
                                                        </td>
                                                        <td *ngIf="order.statusCode == 'RD'"><span
                                                                class="badge badge-info">{{order.orderStatus}}</span>
                                                        </td>
                                                        <td *ngIf="order.statusCode == 'MG'"><span
                                                                class="badge badge-dark">{{order.orderStatus}}</span>
                                                        </td>
                                                        <td *ngIf="order.statusCode == 'D'"><span
                                                                class="badge badge-success">{{order.orderStatus}}</span>
                                                        </td>
                                                        <td *ngIf="order.statusCode == 'OC'"><span
                                                                class="badge badge-danger">{{order.orderStatus}}</span>
                                                        </td>
                                                        <!-- <td>{{order.orderAmount}}</td> -->
                                                        <td class="action-icon">
                                                            <a href="javascript:;" title="View"
                                                                class="m-r-15 crm-action-edit text-muted text-primary"
                                                                data-target=".bd-example-modal-lg"
                                                                data-toggle="modal"><i class="icofont icofont-eye-alt"
                                                                    (click)="ordersview(order.orderInvoiceId, order.orderStatus,order)"></i></a>
                                                            <!-- <a title="Delivered" href="javascript:;" *ngIf="order.orderStatus == 'Ready For Delivery'" class="m-r-15 crm-action-edit text-muted text-primary" (click)="delivered(order.orderInvoiceId)"><i
                              class="icofont icofont-check-circled"></i></a>    -->
                                                            <!-- <button href="javascript:;" data-target=".bd-example-modal-lg" data-toggle="modal" class="btn btn-sm btn-primary" (click)="ordersview(order.orderInvoiceId)">View</button> -->
                                                            <!-- <button *ngIf="order.orderStatus == 'Ready For Delivery'" class="btn btn-sm btn-success" (click)="delivered(order.orderInvoiceId)">Delivered</button> -->
                                                        </td>
                                                    </tr>
                                                </tbody>
                                                <tfoot>
                                                    <tr>
                                                        <td colspan="10">
                                                            <mfBootstrapPaginator class="pagination-main f-right">
                                                            </mfBootstrapPaginator>
                                                            <div *ngIf="!order?.length" class="no-records">
                                                                No records found!...
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tfoot>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Container-fluid Ends-->

        <div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-lg mw-100 w-75">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Ordered Details: </h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="row" style="padding-top: 10px;padding-bottom: 30px;">
                            <div class="col-sm-3"><strong>Address</strong></div>
                            <div class="col-sm-9">{{orderLocation}}</div>
                        </div>
                        <table class="table table-striped table-bordered full-data-table">
                            <thead>
                                <tr>
                                    <th>Category_name</th>
                                    <th>Product name</th>
                                    <th>Net_wgt</th>
                                    <!-- <th>Actual_price</th> -->
                                    <th>Sale_price</th>
                                    <th>Quantity</th>
                                    <th>Sub_total</th>
                                    <th>Fullfillment</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let item of editOrderData">
                                    <td>{{item.categoryName}}</td>
                                    <td>{{item.productName}}</td>
                                    <td>{{item.netWeight}}{{item.measurementName}}</td>
                                    <!-- <td>₹ {{item.actualAmount}}</td> -->
                                    <td>₹ {{item.prodAmount}}</td>
                                    <td>{{item.prodQuantity}}</td>
                                    <td>₹ {{item.prodSubTotal}}</td>
                                    <td><label
                                            *ngIf="orderConfirmstatus != 'Confirmed' && orderConfirmstatus != 'In Progress' &&  orderConfirmstatus != 'Delivered'">Done</label>
                                        <input
                                            *ngIf="orderConfirmstatus === 'Confirmed' || orderConfirmstatus === 'In Progress'"
                                            type="checkbox" [(ngModel)]="item.isFullFilled" (change)="changeCheck()">
                                        <label *ngIf="orderConfirmstatus === 'Delivered'">Delivered</label>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <button type="button"
                                *ngIf="orderConfirmstatus === 'Confirmed' || orderConfirmstatus === 'In Progress'"
                                [disabled]="!checked" class="btn btn-success" data-dismiss="modal"
                                (click)="SelectedData(editOrderData)">Submit</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>